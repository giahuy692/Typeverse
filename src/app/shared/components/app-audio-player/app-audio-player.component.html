<div class="p-6 max-w-4xl mx-auto text-white font-sans bg-[#1e1e2f] space-y-6">

  <!-- Header -->
  <div class="text-center">
    <h1 class="text-2xl font-bold text-white">ğŸ§  Luyá»‡n Táº­p Ká»¹ NÄƒng Nghe â€“ NÃ³i â€“ Video</h1>
    <p class="text-sm text-gray-400 mt-1">Cháº¿ Ä‘á»™ hiá»‡n táº¡i: <span class="text-emerald-400 font-bold">{{ currentMode
        }}</span></p>
  </div>

  <!-- NÃºt báº¯t Ä‘áº§u / káº¿t thÃºc -->
  <div *ngIf="!hasStarted" class="text-center mt-8">
    <button (click)="startApp()"
      class="bg-green-600 hover:bg-green-700 text-white font-semibold px-6 py-3 rounded text-lg">
      â–¶ï¸ Báº¯t Ä‘áº§u luyá»‡n táº­p
    </button>
  </div>

  <div *ngIf="hasStarted">
    <!-- Ã‚m lÆ°á»£ng vÃ  táº¯t/má»Ÿ nháº¡c ná»n -->
    <div *ngIf="isListeningMode" class="space-y-2">
      <label for="volume">ğŸ”Š Ã‚m lÆ°á»£ng ná»n:</label>
      <input type="range" id="volume" min="0" max="1" step="0.05" [value]="backgroundMusic.volume"
        (input)="updateBackgroundVolume($any($event.target).value)" class="w-full accent-emerald-400" />
      <button (click)="toggleBackgroundMute()" class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-1 rounded">
        {{ backgroundMuted ? 'ğŸ”‡ Báº­t láº¡i nháº¡c ná»n' : 'ğŸ”ˆ Táº¯t nháº¡c ná»n' }}
      </button>
    </div>

    <!-- Chuyá»ƒn cháº¿ Ä‘á»™ -->
    <div class="flex justify-center gap-4 py-[10px]">
      <button (click)="toggleMode()" class="bg-emerald-600 hover:bg-emerald-700 px-4 py-2 rounded">
        {{ isListeningMode ? 'ğŸ” Chuyá»ƒn sang NÃ³i' : 'ğŸ” Chuyá»ƒn sang Nghe' }}
      </button>
      <button (click)="toggleVideoMode()" class="bg-indigo-600 hover:bg-indigo-700 px-4 py-2 rounded">
        ğŸ¥ Video BÃ i Há»c
      </button>
      <button (click)="stopApp()" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded">
        â¹ï¸ Káº¿t thÃºc
      </button>
    </div>

    <div *ngIf="answerAudio && !isVideoMode" class="relative overflow-hidden h-20">
<img
  #dog
  src="assets/images/Animation - 1747750875890.gif"
  alt="walking dog"
  class="absolute bottom-0 h-16 transition-all duration-300"
  [style.left.%]="answerProgress"
/>
    </div>

    <div *ngIf="answerAudio && !isVideoMode" class="mt-4 pb-4">
      <div class="flex items-center justify-between text-sm text-gray-300 mb-1">
        <span>â±ï¸ {{ answerCurrentTime | number: '1.0-0' }}s</span>
        <span class="font-medium text-white">Tiáº¿n Ä‘á»™</span>
        <span>{{ answerDuration | number: '1.0-0' }}s</span>
      </div>

      <div class="w-full bg-gray-700 rounded-full h-3 shadow-inner overflow-hidden">
        <div
          class="h-full rounded-full bg-gradient-to-r from-red-400 via-yellow-300 to-green-400 transition-all duration-300"
          [style.width.%]="answerProgress"></div>
      </div>
    </div>


    <!-- Cháº¿ Ä‘á»™ Nghe/NÃ³i -->
    <div *ngIf="currentQuestion && !isVideoMode" class="answer space-y-4 bg-[#2b2b40] p-4 rounded shadow">
      <h2 class="text-xl text-emerald-300 font-semibold">{{ currentQuestion.question }}</h2>
      <p class="text-gray-200 italic">{{ currentQuestion.answer }}</p>

      <div *ngIf="isCountdown" class="text-center text-4xl text-yellow-400 font-bold">
        {{ countdown }}s
      </div>

      <div *ngIf="showEffect" class="text-center text-pink-400 font-bold animate-pulse space-y-2">
        ğŸ”ˆ Äang phÃ¡t cÃ¢u tráº£ lá»i máº«u...
      </div>
    </div>

    <div *ngIf="currentQuestion && !isVideoMode" class="py-[10px]">
      <label class="block text-sm mb-1">ğŸ”‰ Ã‚m lÆ°á»£ng cÃ¢u tráº£ lá»i máº«u:</label>
      <input type="range" min="0" max="1" step="0.05" [value]="audioVolume"
        (input)="updateAllAudioVolume($any($event.target).value)" class="w-full accent-pink-400" />
    </div>

    <div *ngIf="currentQuestion && !isVideoMode" class="py-[10px] flex justify-center gap-x-4">
      <button (click)="answerAudio?.pause()" class="bg-red-600 hover:bg-yellow-600 text-white px-3 py-1 rounded px-4">
        â¸ï¸ Táº¡m dá»«ng
      </button>
      <button (click)="answerAudio?.play()" class="bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded px-4">
        â–¶ï¸ Tiáº¿p tá»¥c
      </button>
    </div>

    <!-- VIDEO PLAYLIST -->
    <div *ngIf="isVideoMode" class="space-y-6">
      <h2 class="text-lg text-center text-pink-300 font-semibold">ğŸ“º Danh sÃ¡ch Video</h2>

      <ul class="space-y-2">
        <li *ngFor="let video of videoPlaylist">
          <button (click)="playVideo(video)"
            class="w-full text-left bg-slate-700 hover:bg-slate-600 text-white px-4 py-2 rounded">
            â–¶ï¸ {{ video.title }}
          </button>
        </li>
      </ul>

      <!-- Video Ä‘ang phÃ¡t -->
      <div *ngIf="selectedVideo && showVideo" class="mt-4 space-y-2">
        <h3 class="text-emerald-400 text-lg">{{ selectedVideo.title }}</h3>
        <video #videoPlayer class="w-full rounded" [src]="selectedVideo.videoPath" [volume]="videoVolume"
          [playbackRate]="videoSpeed" controls autoplay></video>
        <div class="bg-black/70 text-white text-center text-sm px-4 py-2 rounded">{{ selectedVideo.subtitle }}</div>
      </div>
    </div>
  </div>
</div>